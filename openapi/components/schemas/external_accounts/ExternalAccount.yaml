allOf:
  - $ref: ../users/BankAccountBase.yaml
  - type: object
    required:
      - id
      - status
      - beneficiary
    properties:
      id:
        type: string
        description: The system generated identifier of this account
        example: ExternalAccount:e85dcbd6-dced-4ec4-b756-3c3a9ea3d965
      status:
        $ref: ../external_accounts/ExternalAccountStatus.yaml
        description: Status of the external account
        example: ACTIVE
      beneficiary:
        description: Beneficiary of the account
        oneOf:
          - title: Business Counterparty
            $ref: ../counterparty/BusinessCounterParty.yaml
          - title: Individual Counterparty
            $ref: ../counterparty/IndividualCounterParty.yaml
        discriminator:
          propertyName: counterpartyType
          mapping:
            INDIVIDUAL_COUNTERPARTY: ../counterparty/BusinessCounterParty.yaml
            BUSINESS_COUNTERPARTY: ../counterparty/IndividualCounterParty.yaml
