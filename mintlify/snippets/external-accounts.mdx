## Overview

External accounts are bank accounts, cryptocurrency wallets, or payment destinations outside Grid where you can send funds. Grid supports two types:

- **Customer external accounts** - Scoped to individual customers, used for withdrawals and customer-specific payouts
- **Platform external accounts** - Scoped to your platform, used for platform-wide operations like receiving funds from external sources

<Info>
  Customer external accounts require beneficiary information for compliance.
  Platform accounts are managed at the organization level.
</Info>

## How it works

1. **Register account** with required details (beneficiary info for customer accounts, bank details for all)
2. **Wait for verification** (account moves to `ACTIVE` status)
3. **Send payments** using the account as a destination in transfers or quotes
4. **Track status** via webhooks and transaction queries

## Prerequisites

**For customer external accounts:**

- Active Grid API credentials
- At least one customer created
- Valid bank account or wallet information
- Beneficiary information (individual or business)

**For platform external accounts:**

- Active Grid API credentials
- Valid bank account or wallet information for your organization

## Supported account types

<Tabs>
<Tab title="United States">
**ACH, Wire, RTP**

```json
{
  "accountType": "US_ACCOUNT",
  "accountNumber": "123456789",
  "routingNumber": "021000021",
  "accountCategory": "CHECKING",
  "bankName": "Chase Bank",
  "beneficiary": {
    "beneficiaryType": "INDIVIDUAL",
    "fullName": "John Doe",
    "birthDate": "1990-01-15",
    "nationality": "US",
    "address": {
      "line1": "123 Main Street",
      "city": "San Francisco",
      "state": "CA",
      "postalCode": "94105",
      "country": "US"
    }
  }
}
```

<Note>
  Category must be `CHECKING` or `SAVINGS`. Routing number must be 9 digits.
</Note>
</Tab>

<Tab title="Mexico">
**CLABE/SPEI**

```json
{
  "accountType": "CLABE",
  "clabeNumber": "123456789012345678",
  "bankName": "BBVA Mexico",
  "beneficiary": {
    "beneficiaryType": "INDIVIDUAL",
    "fullName": "María García",
    "birthDate": "1985-03-15",
    "nationality": "MX",
    "address": {
      "line1": "Av. Reforma 123",
      "city": "Ciudad de México",
      "state": "CDMX",
      "postalCode": "06600",
      "country": "MX"
    }
  }
}
```

</Tab>

<Tab title="Brazil">
**PIX**

```json
{
  "accountType": "PIX",
  "pixKey": "user@email.com",
  "pixKeyType": "EMAIL",
  "bankName": "Nubank",
  "beneficiary": {
    "beneficiaryType": "INDIVIDUAL",
    "fullName": "João Silva",
    "birthDate": "1988-07-22",
    "nationality": "BR",
    "address": {
      "line1": "Rua das Flores 456",
      "city": "São Paulo",
      "state": "SP",
      "postalCode": "01234-567",
      "country": "BR"
    }
  }
}
```

<Tip>Key types: `CPF`, `CNPJ`, `EMAIL`, `PHONE`, or `RANDOM`</Tip>
</Tab>

<Tab title="Europe">
**IBAN/SEPA**

```json
{
  "accountType": "IBAN",
  "iban": "DE89370400440532013000",
  "swiftBic": "DEUTDEFF",
  "bankName": "Deutsche Bank",
  "beneficiary": {
    "beneficiaryType": "INDIVIDUAL",
    "fullName": "Hans Schmidt",
    "birthDate": "1982-11-08",
    "nationality": "DE",
    "address": {
      "line1": "Hauptstraße 789",
      "city": "Berlin",
      "state": "Berlin",
      "postalCode": "10115",
      "country": "DE"
    }
  }
}
```

</Tab>

<Tab title="India">
**UPI**

```json
{
  "accountType": "UPI",
  "vpa": "user@okbank",
  "beneficiary": {
    "beneficiaryType": "INDIVIDUAL",
    "fullName": "Priya Sharma",
    "birthDate": "1991-05-14",
    "nationality": "IN",
    "address": {
      "line1": "123 MG Road",
      "city": "Mumbai",
      "state": "Maharashtra",
      "postalCode": "400001",
      "country": "IN"
    }
  }
}
```

</Tab>

<Tab title="Cryptocurrency">
**Bitcoin Lightning (Spark Wallet)**

```json
{
  "accountType": "SPARK_WALLET",
  "address": "sprt1pgssyuuuhnrrdjswal5c3s3rafw9w3y5dd4cjy3duxlf7hjzkp0rqx6dj6mrhu"
}
```

<Note>
  Spark wallets don't require beneficiary information as they are self-custody wallets.
</Note>
</Tab>
</Tabs>

## Creating customer external accounts

Add an external account for a specific customer:

<CodeGroup>
```bash cURL
curl -X POST 'https://api.lightspark.com/grid/2025-10-13/customers/external-accounts' \
  -H 'Authorization: Basic <base64-encoded-credentials>' \
  -H 'Content-Type: application/json' \
  -d '{
    "currency": "USD",
    "platformAccountId": "user_123_primary_bank",
    "accountInfo": {
      "accountType": "US_ACCOUNT",
      "accountNumber": "123456789",
      "routingNumber": "021000021",
      "accountCategory": "CHECKING",
      "bankName": "Chase Bank",
      "beneficiary": {
        "beneficiaryType": "INDIVIDUAL",
        "fullName": "John Doe",
        "birthDate": "1990-01-15",
        "nationality": "US",
        "address": {
          "line1": "123 Main Street",
          "city": "San Francisco",
          "state": "CA",
          "postalCode": "94105",
          "country": "US"
        }
      }
    }
  }'
```

```javascript Node.js
const response = await fetch(
  "https://api.lightspark.com/grid/2025-10-13/customers/external-accounts",
  {
    method: "POST",
    headers: {
      Authorization: `Basic ${Buffer.from(
        `${apiTokenId}:${apiSecret}`
      ).toString("base64")}`,
      "Content-Type": "application/json",
    },
    body: JSON.stringify({
      currency: "USD",
      platformAccountId: "user_123_primary_bank",
      accountInfo: {
        accountType: "US_ACCOUNT",
        accountNumber: "123456789",
        routingNumber: "021000021",
        accountCategory: "CHECKING",
        bankName: "Chase Bank",
        beneficiary: {
          beneficiaryType: "INDIVIDUAL",
          fullName: "John Doe",
          birthDate: "1990-01-15",
          nationality: "US",
          address: {
            line1: "123 Main Street",
            city: "San Francisco",
            state: "CA",
            postalCode: "94105",
            country: "US"
          }
        }
      }
    }),
  }
);

const externalAccount = await response.json();
console.log("External account created:", externalAccount.id);
```

```python Python
import requests
import base64
import json

credentials = base64.b64encode(
    f"{api_token_id}:{api_secret}".encode()
).decode()

response = requests.post(
    'https://api.lightspark.com/grid/2025-10-13/customers/external-accounts',
    headers={
        'Authorization': f'Basic {credentials}',
        'Content-Type': 'application/json'
    },
    json={
        'customerId': 'Customer:019542f5-b3e7-1d02-0000-000000000001',
        'currency': 'USD',
        'platformAccountId': 'user_123_primary_bank',
        'accountInfo': {
            'accountType': 'US_ACCOUNT',
            'accountNumber': '123456789',
            'routingNumber': '021000021',
            'accountCategory': 'CHECKING',
            'bankName': 'Chase Bank',
            'beneficiary': {
                'beneficiaryType': 'INDIVIDUAL',
                'fullName': 'John Doe',
                'birthDate': '1990-01-15',
                'nationality': 'US',
                'address': {
                    'line1': '123 Main Street',
                    'city': 'San Francisco',
                    'state': 'CA',
                    'postalCode': '94105',
                    'country': 'US'
                }
            }
        }
    }
)

external_account = response.json()
print(f"External account created: {external_account['id']}")
```

</CodeGroup>

**Response:**

```json
{
  "id": "ExternalAccount:e85dcbd6-dced-4ec4-b756-3c3a9ea3d965",
  "customerId": "Customer:019542f5-b3e7-1d02-0000-000000000001",
  "status": "ACTIVE",
  "currency": "USD",
  "platformAccountId": "user_123_primary_bank",
  "accountInfo": {
    "accountType": "US_ACCOUNT",
    "accountNumber": "123456789",
    "routingNumber": "021000021",
    "accountCategory": "CHECKING",
    "bankName": "Chase Bank",
    "beneficiary": {
      "beneficiaryType": "INDIVIDUAL",
      "fullName": "John Doe",
      "birthDate": "1990-01-15",
      "nationality": "US",
      "address": {
        "line1": "123 Main Street",
        "city": "San Francisco",
        "state": "CA",
        "postalCode": "94105",
        "country": "US"
      }
    }
  }
}
```

### Business beneficiaries

For business accounts, include business information:

```json
{
  "currency": "USD",
  "platformAccountId": "acme_corp_account",
  "customerId": "Customer:019542f5-b3e7-1d02-0000-000000000001",
  "accountInfo": {
    "accountType": "US_ACCOUNT",
    "accountNumber": "987654321",
    "routingNumber": "021000021",
    "accountCategory": "CHECKING",
    "bankName": "Chase Bank",
    "beneficiary": {
      "beneficiaryType": "BUSINESS",
      "businessInfo": {
        "legalName": "Acme Corporation, Inc.",
        "taxId": "EIN-987654321"
      },
      "address": {
        "line1": "456 Business Ave",
        "city": "New York",
        "state": "NY",
        "postalCode": "10001",
        "country": "US"
      }
    }
  }
}
```

### Platform account IDs

Link external accounts to your internal system using `platformAccountId`:

```json
{
  "currency": "USD",
  "platformAccountId": "user_123_primary_bank",
  "customerId": "Customer:019542f5-b3e7-1d02-0000-000000000001",
  ...
}
```

<Tip>Use `platformAccountId` for easier reconciliation with your database.</Tip>

## Account status

| Status         | Description                         |
| -------------- | ----------------------------------- |
| `PENDING`      | Created, awaiting verification      |
| `ACTIVE`       | Verified and ready for transactions |
| `UNDER_REVIEW` | Additional review required          |
| `INACTIVE`     | Disabled, cannot be used            |

<Warning>Only `ACTIVE` accounts can receive payments.</Warning>

## Listing external accounts

### List customer accounts

```bash
curl -X GET 'https://api.lightspark.com/grid/2025-10-13/customers/external-accounts?customerId=Customer:019542f5-b3e7-1d02-0000-000000000001' \
  -H 'Authorization: Basic <base64-encoded-credentials>'
```

### List platform accounts

For platform-wide operations, list all platform-level external accounts:

```bash
curl -X GET 'https://api.lightspark.com/grid/2025-10-13/platform/external-accounts' \
  -H 'Authorization: Basic <base64-encoded-credentials>'
```

<Info>
  Platform external accounts are used for platform-wide operations like
  receiving funds from external sources.
</Info>

## Using external accounts in payments

### Same-currency transfers

Use `/transfer-out` for transfers without currency exchange:

```bash
curl -X POST 'https://api.lightspark.com/grid/2025-10-13/transfer-out' \
  -H 'Authorization: Basic <base64-encoded-credentials>' \
  -H 'Content-Type: application/json' \
  -d '{
    "source": {
      "accountId": "InternalAccount:a12dcbd6-dced-4ec4-b756-3c3a9ea3d123"
    },
    "destination": {
      "accountId": "ExternalAccount:e85dcbd6-dced-4ec4-b756-3c3a9ea3d965"
    },
    "amount": 50000
  }'
```

### Cross-currency transfers

For currency exchange, create and execute a quote:

```bash
# 1. Create quote
curl -X POST 'https://api.lightspark.com/grid/2025-10-13/quotes' \
  -H 'Authorization: Basic <base64-encoded-credentials>' \
  -H 'Content-Type: application/json' \
  -d '{
    "source": {
      "accountId": "InternalAccount:a12dcbd6-dced-4ec4-b756-3c3a9ea3d123"
    },
    "destination": {
      "accountId": "ExternalAccount:e85dcbd6-dced-4ec4-b756-3c3a9ea3d965",
      "currency": "MXN"
    },
    "lockedCurrencySide": "RECEIVING",
    "lockedCurrencyAmount": 1000000
  }'

# 2. Execute quote (using the quote ID from the response above)
curl -X POST 'https://api.lightspark.com/grid/2025-10-13/quotes/<quote-id>/execute' \
  -H 'Authorization: Basic <base64-encoded-credentials>' \
  -H 'Content-Type: application/json'
```

### Lookup receiver details

Check supported currencies and rates before creating a quote:

```bash
curl -X GET 'https://api.lightspark.com/grid/2025-10-13/receiver/external-account/ExternalAccount:e85dcbd6...?customerId=Customer:019542f5...' \
  -H 'Authorization: Basic <base64-encoded-credentials>'
```

## Common use cases

### International contractor payments

Register external accounts for contractors in different countries, then use them as payment destinations:

```bash
# Example: Register a Mexican contractor's CLABE account
curl -X POST 'https://api.lightspark.com/grid/2025-10-13/customers/external-accounts' \
  -H 'Authorization: Basic <base64-encoded-credentials>' \
  -H 'Content-Type: application/json' \
  -d '{
    "customerId": "Customer:019542f5-b3e7-1d02-0000-000000000001",
    "currency": "MXN",
    "platformAccountId": "contractor_mx_001",
    "accountInfo": {
      "accountType": "CLABE",
      "clabeNumber": "123456789012345678",
      "bankName": "BBVA Mexico",
      "beneficiary": {
        "beneficiaryType": "INDIVIDUAL",
        "fullName": "María García",
        "birthDate": "1985-03-15",
        "nationality": "MX",
        "address": {
          "line1": "Av. Reforma 123",
          "city": "Ciudad de México",
          "state": "CDMX",
          "postalCode": "06600",
          "country": "MX"
        }
      }
    }
  }'
```

Repeat for contractors in other countries (Brazil PIX, India UPI, etc.) and store the returned account IDs for future payments.

### Cryptocurrency withdrawals

```bash
# 1. Add Bitcoin Lightning wallet as external account
curl -X POST 'https://api.lightspark.com/grid/2025-10-13/customers/external-accounts' \
  -H 'Authorization: Basic <base64-encoded-credentials>' \
  -H 'Content-Type: application/json' \
  -d '{
    "customerId": "Customer:019542f5-b3e7-1d02-0000-000000000001",
    "currency": "BTC",
    "platformAccountId": "crypto_wallet_user_123",
    "accountInfo": {
      "accountType": "SPARK_WALLET",
      "address": "sprt1pgssyuuuhnrrdjswal5c3s3rafw9w3y5dd4cjy3duxlf7hjzkp0rqx6dj6mrhu"
    }
  }'

# 2. Create quote for withdrawal (using the external account ID from response)
curl -X POST 'https://api.lightspark.com/grid/2025-10-13/quotes' \
  -H 'Authorization: Basic <base64-encoded-credentials>' \
  -H 'Content-Type: application/json' \
  -d '{
    "source": {
      "accountId": "InternalAccount:a12dcbd6-dced-4ec4-b756-3c3a9ea3d123"
    },
    "destination": {
      "accountId": "ExternalAccount:e85dcbd6-dced-4ec4-b756-3c3a9ea3d965",
      "currency": "BTC"
    },
    "lockedCurrencySide": "SENDING",
    "lockedCurrencyAmount": 10000
  }'
```

## Best practices

<AccordionGroup>
<Accordion title="Validate account information">
Validate account details before submission to avoid errors:

- **US accounts**: Routing number must be 9 digits, account number 4-17 digits
- **CLABE (Mexico)**: Exactly 18 digits
- **PIX (Brazil)**: Format depends on key type (CPF, email, phone, etc.)
- **IBAN (Europe)**: Length varies by country (15-34 characters)

Implement validation in your application before making API calls.

</Accordion>

<Accordion title="Check account status">
Always verify the account status is `ACTIVE` before sending payments. Accounts in `PENDING`, `UNDER_REVIEW`, or `INACTIVE` status cannot receive transfers. Check the `status` field in the account object returned by the API.

</Accordion>

<Accordion title="Secure account data">
Never expose full account numbers in your UI or logs. Display only masked information such as:

- Bank name
- Last 4 digits of account number
- Account type
- Account status

This protects sensitive financial data while still allowing users to identify their accounts.

</Accordion>

<Accordion title="Use platformAccountId">
Use the `platformAccountId` field to link Grid external accounts to your internal database. This makes reconciliation easier by allowing you to map Grid account IDs to your own system's identifiers (e.g., `db_account_${yourDatabaseId}` or `user_${userId}_bank_account`).

</Accordion>
</AccordionGroup>
