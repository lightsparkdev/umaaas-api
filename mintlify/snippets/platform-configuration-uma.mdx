<Info>
Use the `/config` endpoint to view and update your platform configuration for UMA address payments.
Authentication: HTTP Basic (client_id as username, client_secret as password).
</Info>

## Retrieve Current Configuration

You can retrieve your current platform configuration to see what settings are already in place:

```bash cURL
curl -X GET 'https://api.lightspark.com/grid/2025-10-13/config' \
  -u 'YOUR_CLIENT_ID:YOUR_CLIENT_SECRET'
```

```json Success
{
  "id": "PlatformConfig:019542f5-b3e7-1d02-0000-000000000003",
  "umaDomain": "example.com",
  "proxyUmaSubdomain": "example",
  "webhookEndpoint": "https://api.example.com/webhooks/grid",
  "supportedCurrencies": [
    {
      "currencyCode": "USD",
      "minAmount": 100,
      "maxAmount": 1000000,
      "requiredCounterpartyFields": [
        { "name": "FULL_NAME", "mandatory": true },
        { "name": "BIRTH_DATE", "mandatory": true }
      ],
      "enabledTransactionTypes": ["OUTGOING", "INCOMING"],
      "umaProviderRequiredCustomerFields": [
        "NATIONALITY",
        "BIRTH_DATE"
      ],
      "umaProviderRequiredCounterpartyCustomerFields": [
        "FULL_NAME",
        "COUNTRY_OF_RESIDENCE"
      ]
    }
  ],
  "createdAt": "2023-06-15T12:30:45Z",
  "updatedAt": "2023-07-01T10:00:00Z"
}
```

<Note>
If this is your first time configuring the platform, some default values may be returned which were set up when you first created your account.
</Note>

## Update Platform Configuration

To update your platform configuration for UMA payments, use the PATCH endpoint:

```bash cURL
curl -X PATCH 'https://api.lightspark.com/grid/2025-10-13/config' \
  -u 'YOUR_CLIENT_ID:YOUR_CLIENT_SECRET' \
  -H 'Content-Type: application/json' \
  -d '{
    "umaDomain": "mycompany.com",
    "webhookEndpoint": "https://api.mycompany.com/webhooks/grid",
    "supportedCurrencies": [
      {
        "currencyCode": "USD",
        "minAmount": 100,
        "maxAmount": 1000000,
        "enabledTransactionTypes": ["OUTGOING", "INCOMING"],
        "requiredCounterpartyFields": [
          { "name": "FULL_NAME", "mandatory": true },
          { "name": "BIRTH_DATE", "mandatory": true },
          { "name": "ADDRESS", "mandatory": false }
        ]
      }
    ]
  }'
```

```json Success
{
  "id": "PlatformConfig:019542f5-b3e7-1d02-0000-000000000003",
  "umaDomain": "mycompany.com",
  "proxyUmaSubdomain": "mycompany",
  "webhookEndpoint": "https://api.mycompany.com/webhooks/grid",
  "supportedCurrencies": [
    {
      "currencyCode": "USD",
      "minAmount": 100,
      "maxAmount": 1000000,
      "requiredCounterpartyFields": [
        { "name": "FULL_NAME", "mandatory": true },
        { "name": "BIRTH_DATE", "mandatory": true },
        { "name": "ADDRESS", "mandatory": false }
      ],
      "enabledTransactionTypes": ["OUTGOING", "INCOMING"],
      "umaProviderRequiredCustomerFields": [
        "NATIONALITY",
        "BIRTH_DATE"
      ],
      "umaProviderRequiredCounterpartyCustomerFields": [
        "FULL_NAME",
        "COUNTRY_OF_RESIDENCE"
      ]
    }
  ],
  "createdAt": "2023-06-15T12:30:45Z",
  "updatedAt": "2023-06-15T12:30:45Z"
}
```

<Warning>
The `webhookSecret` is not returned in the response. It can only be retrieved from the Grid dashboard. Store this securely as it's used to verify the authenticity of webhooks (see the [Webhook Verification Guide](/remittances/webhooks)).
</Warning>

## Configuration Parameters for UMA Payments

### UMA Domain

The `umaDomain` parameter defines the domain part of all UMA addresses for your users. For example, if you set `umaDomain` to `mycompany.com`, your users' UMA addresses will follow the format `$username@mycompany.com`.

Requirements for a valid UMA domain:

- Must be a valid domain name format
- Should be a domain that you control
- Must proxy incoming requests to the Grid API as follows:
  - `https://<umaDomain>/.well-known/lnurlp/*` -> `https://<proxyUmaSubdomain>.umaaas.uma.money/.well-known/lnurlp/*`
  - `https://<umaDomain>/.well-known/lnurlpubkey` -> `https://<proxyUmaSubdomain>.umaaas.uma.money/.well-known/lnurlpubkey`
  - `https://<umaDomain>/.well-known/uma-configuration` -> `https://<proxyUmaSubdomain>.umaaas.uma.money/.well-known/uma-configuration`

### Webhook Endpoint

The `webhookEndpoint` parameter specifies the URL where Grid will send webhook notifications about payment events. Your webhook endpoint must:

- Be publicly accessible over HTTPS
- Respond with appropriate HTTP status codes
- Handle webhook verification (see [Webhook Verification Guide](/remittances/webhooks))
- Process webhook payloads within a reasonable time (recommended: under 5 seconds)

### Supported Currencies for UMA

The `supportedCurrencies` array allows you to define settings for each currency your platform will support for UMA payments. Each object in this array can contain:

- `currencyCode`: (String, required) The ISO 4217 currency code (e.g., "USD").
- `minAmount`: (Integer, required) Minimum transaction amount in the smallest unit of the currency.
- `maxAmount`: (Integer, required) Maximum transaction amount in the smallest unit of the currency.
- `requiredCounterpartyFields`: (Array, required) Defines PII your platform requires about *external counterparties* for transactions in this currency.
- `enabledTransactionTypes`: (Array, optional) Specifies which transaction types are allowed (e.g., `["OUTGOING", "INCOMING"]`).
- `umaProviderRequiredCustomerFields`: (Array, read-only) Lists user info field names that the UMA provider mandates for *your own users* to transact in this currency.
- `umaProviderRequiredCounterpartyCustomerFields`: (Array, read-only) Lists counterparty field names that the UMA provider mandates for external counterparties.

### Required Counterparty Fields

Within each currency defined in `supportedCurrencies`, the `requiredCounterpartyFields` parameter allows you to specify what information your platform needs to collect from *external counterparties* (senders or receivers) involved in transactions with your users for that specific currency.

Available counterparty fields (to be specified with a `name` and `mandatory` flag):

| Field Name (type `UserInfoFieldName`) | Description |
|---------------------------------------|-------------|
| `FULL_NAME` | Full legal name of the individual or business |
| `BIRTH_DATE` | Date of birth in YYYY-MM-DD format (for individuals) |
| `NATIONALITY` | Nationality of the individual |
| `ADDRESS` | Physical address including country, city, etc. |
| `PHONE_NUMBER` | Contact phone number including country code |
| `EMAIL` | Email address |
| `BUSINESS_NAME` | Legal business name (for business entities) |
| `TAX_ID` | Tax identification number |
| `COUNTRY_OF_RESIDENCE` | Country where the individual resides |

Each field in `requiredCounterpartyFields` is an object containing:

- `name`: The `UserInfoFieldName` representing the PII you require.
- `mandatory`: A boolean (true/false) indicating if this field is strictly required by your platform for transactions in this currency.

This information will be provided to your platform via webhooks for pending payments, allowing you to screen the counterparty based on your compliance rules before approving the payment.

### UMA Provider Required Fields

Also within each currency defined in `supportedCurrencies`, you will find two arrays:

- `umaProviderRequiredCustomerFields`: Lists user information fields mandated by the UMA provider for *your own registered users* to transact in this currency.
- `umaProviderRequiredCounterpartyCustomerFields`: Lists counterparty information fields mandated by the UMA provider for external counterparties.

These fields must be supplied when creating or updating users or counterparties via the respective API endpoints if they are expected to use the specified currency. Refer to the [Configuring Users](remittances/developer-guides/configuring-users) guide for more details on how this impacts user setup.

## Verify Configuration

After updating your configuration, it's recommended to verify that the changes were saved correctly:

```bash cURL
curl -X GET 'https://api.lightspark.com/grid/2025-10-13/config' \
  -u 'YOUR_CLIENT_ID:YOUR_CLIENT_SECRET'
```

<Warning>
PATCH may return 400 for validation errors, 401 for authentication issues, and 500/501 for server or unsupported operations.
</Warning>
