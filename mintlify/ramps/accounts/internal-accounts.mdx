---
title: "Internal Accounts"
description: "Manage internal accounts for holding fiat and crypto balances for ramp operations"
---

import InternalAccountsContent from "/snippets/internal-accounts.mdx";

<InternalAccountsContent />

## Using internal accounts for ramps

Internal accounts play a critical role in both on-ramp and off-ramp flows:

### For on-ramps (Fiat → Crypto)

Internal accounts are optional for on-ramp flows using just-in-time (JIT) funding:

- **JIT funding**: Quotes provide payment instructions directly; funds flow through without requiring an internal account
- **Pre-funded model**: Deposit fiat to internal account first, then create and execute conversion quotes

<Tip>
  Most on-ramp implementations use JIT funding to avoid holding customer
  balances and simplify compliance.
</Tip>

### For off-ramps (Crypto → Fiat)

Internal accounts are essential for off-ramp flows:

1. **Deposit crypto**: Transfer Bitcoin or stablecoins to the internal account
2. **Hold balance**: Crypto balance is held securely until conversion
3. **Execute conversion**: Create and execute quote to convert crypto to fiat and send to bank account

<Info>
  Off-ramps require pre-funded internal accounts with crypto balances. Grid
  supports BTC, USDC, USDT, and USDB deposits.
</Info>

## Crypto funding for internal accounts

For off-ramp operations, fund internal accounts with cryptocurrency:

### Bitcoin (Lightning Network)

Internal accounts can receive Bitcoin via Lightning Network:

```json
{
  "fundingPaymentInstructions": [
    {
      "accountType": "SPARK_WALLET",
      "asset": "BTC",
      "address": "sprt1pgssyuuuhnrrdjswal5c3s3rafw9w3y5dd4cjy3duxlf7hjzkp0rqx6dj6mrhu",
      "invoice": "lnbc15u1p3xnhl2pp5jptserfk3zk4qy42tlucycrfwxhydvlemu9pqr93tuzlv9cc7g3s..."
    }
  ]
}
```

**Deposit methods:**

- **Spark address**: Reusable address for multiple deposits
- **Lightning invoice**: Single-use invoice for specific amounts

<Note>
  Lightning Network transfers are typically instant and have minimal fees,
  making them ideal for crypto deposits.
</Note>

### Stablecoins (USDC, USDT, USDB)

Internal accounts can also receive stablecoins via Lightning Network:

```json
{
  "fundingPaymentInstructions": [
    {
      "accountType": "SPARK_WALLET",
      "asset": "USDB",
      "address": "sprt1pgssyuuuhnrrdjswal5c3s3rafw9w3y5dd4cjy3duxlf7hjzkp0rqx6dj6mrhu"
    }
  ]
}
```

<Tip>
  Stablecoins like USDB are 1:1 pegged to USD, offering price stability for
  off-ramp balances while maintaining instant settlement via Lightning Network.
</Tip>

## Multi-currency balances

Internal accounts support both fiat and crypto balances:

### Example: Account with USD and BTC

```json
{
  "data": [
    {
      "id": "InternalAccount:usd123",
      "customerId": "Customer:cust001",
      "balance": {
        "amount": 100000,
        "currency": {
          "code": "USD",
          "name": "United States Dollar",
          "symbol": "$",
          "decimals": 2
        }
      }
    },
    {
      "id": "InternalAccount:btc456",
      "customerId": "Customer:cust001",
      "balance": {
        "amount": 10000000,
        "currency": {
          "code": "BTC",
          "name": "Bitcoin",
          "symbol": "₿",
          "decimals": 8
        }
      }
    }
  ]
}
```

<Warning>
  Always check the `decimals` field when working with balances. USD uses 2
  decimals (cents), while BTC uses 8 decimals (satoshis).
</Warning>

## Monitoring account balance changes

Subscribe to `ACCOUNT_STATUS` webhooks to receive real-time balance updates:

```json
{
  "accountId": "InternalAccount:btc456",
  "oldBalance": {
    "amount": 5000000,
    "currency": { "code": "BTC", "decimals": 8 }
  },
  "newBalance": {
    "amount": 10000000,
    "currency": { "code": "BTC", "decimals": 8 }
  },
  "timestamp": "2025-10-03T14:32:00Z",
  "webhookId": "Webhook:webhook001",
  "type": "ACCOUNT_STATUS"
}
```

<Check>
  Balance updates are triggered by: - Incoming deposits (fiat or crypto) - Quote
  executions (funds debited) - Failed transaction reversals (funds credited
  back)
</Check>

## Ramp-specific use cases

### Pre-funding for off-ramps

Maintain crypto balances for instant fiat conversions:

```javascript
// Check Bitcoin balance before off-ramp
const accounts = await getInternalAccounts(customerId);
const btcAccount = accounts.data.find(
  (acc) => acc.balance.currency.code === "BTC"
);

if (btcAccount.balance.amount >= requiredSats) {
  // Create quote to convert BTC to fiat
  const quote = await createQuote({
    source: { accountId: btcAccount.id },
    destination: { accountId: bankAccountId, currency: "USD" },
    lockedCurrencySide: "SENDING",
    lockedCurrencyAmount: requiredSats,
  });

  // Execute conversion
  await executeQuote(quote.id);
}
```

### Platform treasury management

Use platform-level internal accounts for pooled liquidity:

```bash
# Get platform internal accounts
curl -X GET 'https://api.lightspark.com/grid/2025-10-13/platform/internal-accounts?currency=BTC' \
  -H 'Authorization: Basic <base64-encoded-credentials>'
```

<Info>
  Platform internal accounts enable centralized treasury management for
  high-volume ramp operations.
</Info>

## Best practices for ramps

<AccordionGroup>
<Accordion title="Choose the right funding model">
- **On-ramps**: Use JIT funding to avoid holding customer fiat
- **Off-ramps**: Pre-fund with crypto for instant fiat conversions
- **High volume**: Consider platform-level accounts for pooled liquidity
</Accordion>

<Accordion title="Monitor crypto price exposure">
```javascript
// Track BTC value in USD
const btcBalance = account.balance.amount; // satoshis
const currentRate = await getBtcUsdRate();
const usdValue = (btcBalance / 100000000) * currentRate;

if (usdValue > maxExposure) {
// Convert excess BTC to stablecoin
await convertToStablecoin(btcBalance - targetBalance);
}

````
</Accordion>

<Accordion title="Implement balance alerts">
Set up proactive notifications for low balances:
```javascript
// Alert when off-ramp liquidity is low
if (btcAccount.balance.amount < minimumSats) {
  await alertTreasury({
    type: 'LOW_CRYPTO_BALANCE',
    account: btcAccount.id,
    balance: btcAccount.balance.amount,
    minimumRequired: minimumSats
  });
}
````

</Accordion>
</AccordionGroup>

## Next steps

- [External Accounts](/ramps/accounts/external-accounts) - Configure destination accounts for conversions
- [Plaid Integration](/ramps/accounts/plaid) - Connect bank accounts via Plaid
- [Fiat-to-Crypto Conversion](/ramps/conversion-flows/fiat-crypto-conversion) - Build conversion flows
- [Webhooks](/ramps/platform-tools/webhooks) - Handle real-time notifications

## Related resources

- [Platform Configuration](/ramps/onboarding/platform-configuration) - Configure supported currencies
- [Sandbox Testing](/ramps/platform-tools/sandbox-testing) - Test funding and conversions safely
- [API Reference](/api-reference) - Complete API documentation
